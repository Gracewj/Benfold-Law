---
title: "Benford Analysis on GDP in real 2011 US dollars"
author: "Albert Ding, Yifeng Luo, Kaiyu Yan, Wenjia Xie"
date: "November 29, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,out.width="0.9\\linewidth",dev="png",fig.align  = 'center')
pacman::p_load(
tidyverse,
knitr,
magrittr,
benford.analysis
)
```

# Introduction of the Data Sets 
We are performing our analysis on a dataset from the University of Groningen in the Netherlands compiled as part of The Maddison Project. 

The Maddison Project was initiated in 2010 to measure economic performance for different regions, time periods, and subtopics. The database presents annual GDP estimates for every country in the world going back as early as the 1800s.

# Benford analysis on GDP in real 2011 US$M
Below we read in and clean the data. The attribute of interest we are examining is the annual GDP of each country by year. In order to get this data, we take the GDP per capita normalized in real 2011 purchasing power terms and multiply by the population in thousands. We divide this number by 1000 again in order get the figure in $USD in millions.  

```{r}
globalgdp <- read_csv("Madison_GDP.csv") %>%
    filter(cgdppc != "" & pop != "NA") %>%
    mutate(cgdp = cgdppc/1000*pop)
```

```{r}
bfd.gdp <- benford(globalgdp$cgdp)
plot(bfd.gdp)
bfd.gdp
```

From the first plot, we can see that the original GDP data is in blue and the expected frequency according to Benford's law is in red. In our example, the first plot shows that the data do have a tendency to follow Benford's law, and there is only a subtle difference for some digits. 

This result can also be verified by Chi-squared difference test. The calculated chi-square statistic here is 69.086 and the p-value of the test is 0.932,which indicate that We do not have sufficient evidence to reject the null hypothesis of conformity to Benfordâ€™s Law.

For the Digits Distribution Second Order Test plot, there is also no obvious discrepency between the original data and the expected frequency according to Benford's law, which can alao be an evidence that there is no obvious detected errors in data downloads, rounded data, data generated by statistical procedures, and the inaccurate ordering of data. 


```{r}
suspects_ranked <- suspectsTable(bfd.gdp)
suspects1 <- getSuspects(bfd.gdp, globalgdp, by='absolute.diff', how.many=5)
suspects1
#Twodigitsuspect1 <- suspects %>%mutate(cgdptwo = substr(cgdp,1,2))
#unique(Twodigitsuspect1$cgdptwo)
#chisq(bfd.gdp)

# suspects2 <- getSuspects(bfd.gdp, globalgdp, by='difference', how.many=5)
# suspects2
# Twodigitsuspect2 <- suspects %>%
#   mutate(cgdptwo = substr(cgdp,1,2))
# 
# suspects3 <- getSuspects(bfd.gdp, globalgdp, by='squared.diff', how.many=5)
# suspects3
# Twodigitsuspect3 <- suspects %>%
#   mutate(cgdptwo = substr(cgdp,1,2))
# 
# suspects4 <- getSuspects(bfd.gdp, globalgdp, by='absolute.diff', how.many=5)
# suspects4
# Twodigitsuspect4 <- suspects %>%
#   mutate(cgdptwo = substr(cgdp,1,2))

# unique(Twodigitsuspect2$cgdptwo)
# unique(Twodigitsuspect3$cgdptwo)
# unique(Twodigitsuspect4$cgdptwo)

```

The first two digit come from the suspect result just align to the "suspects_ranked". In other words, the suspects list generates all the country years that start with the two digit figures of the first n number of chi square differences that appear to suggest some abnormality in frequency, which is bizzare because it does not generate the two with the biggest chi square numbers. In commented code we have confirmed this method of the function and also compared the suspects generated by all four methods, concluding that the four methods actually generate the same suspects.